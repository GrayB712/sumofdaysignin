<!DOCTYPE html>
<html>
<center>
<head>
<p style="font-family:Arial;color:green; font-size:40px" id="errors">
</p>
</head>
<body onload="dispKey()">

<input id="passcode" cols="20" rows="5" style="width:300px; height:40px" placeholder="Paste your sign in code here"></input>

<p id="p1" style="color:green"></p>
<p>

</p>
<button onclick="checkPassword()" style="background:darkblue; color:white; border:none; border-radius:10px; width:110px; height:40px">Sign In</button>
<br>
  <p style="font-family:Arial; font-size:20px">OR</p>
  <p style="font-family:Arial; font-size:20px">Scroll down to create a new account</p>
  <br>
 
  
<script>
const keys = ["jmKf5", "dWgd5", "iM5cZ", "IVd41", "zIIFu", "yAKwj", "irPjn", "hKhG3", "t3bKD", "87omS", "MBOUi", "7NCH5", "ai0fI", "3uN3W", "dAbt6", "nGS26", "jSzNX", "YiP9S", "lk9HV", "xE7QS", "Vg3lw", "WCDjN", "85tsN", "vtGEH", "yQp1u", "ubT9Q", "0eeNk", "MYDMD", "Gknu6", "2rI2r", "0l5dH", "zjXnJ", "24RcV", "zjLdl", "yT9n8", "uZ78I", "JC6e7", "fSDdY", "jkB8v", "LDEO7"];
 //<form action="https://sites.google.com/trojans.oklahomabible.com/fu8io3ry98732yigew32u/Add-a-Post">
         //<button type="submit" href="https://pentasyllabic-nozzl.000webhostapp.com/" style="color:white; border:none; background:darkblue; border-radius:10px; width:150px; height:40px">Create an Account</button>
      //</form>
function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  console.log("getting the cookie");
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      console.log("got the cookie");
      return c.substring(name.length, c.length);
    }
  }
  return "";
}

function dispKey() {
   //setCookie("key", "034jf", 5);
   const oldString = getCookie("key");
  console.log("trying to disp key");
   if(oldString != "")
   {
     console.log("displaying key");
      document.getElementById("errors").innerHTML="Actually, nevermind. You are already signed in!";
   }
}

function setCookie(cname, cvalue, exdays) {
  console.log("setting the cookie");
  const d = new Date();
  d.setTime(d.getTime() + (exdays*24*60*60*1000));
  let expires = "expires="+ d.toUTCString();
  document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
  //document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/; domain=grayb712.github.io"
}
      

     
      function checkPassword(){
        console.log("Checking password");
        var str = "github_pat_" + document.getElementById("passcode").value;
        console.log("this is the string" + str);
        var lastCharfive = str.at(-5);
        var lastCharfour = str.at(-4);
        var lastCharthree = str.at(-3);
        var lastChartwo = str.at(-2);
        var lastCharone = str.at(-1);
        var firstSevenChars = document.getElementById("passcode").value.slice(0, 7);
        //console.log("these are the first seven characters" + firstSevenChars);
        var isKey = 0;
        const lastChars = lastCharfive + lastCharfour + lastCharthree + lastChartwo + lastCharone;
        //document.getElementById("p1").innerHTML = lastChars;
        for (let i = 0; i < (keys.length + 1); i++) {
         // console.log("This is outside the first seven chars")
          if(firstSevenChars === "11A2AOD")
          {
            //console.log("The first 7 are the same!")
          if(keys[i] === lastChars){
            document.getElementById("p1").innerHTML = "Success! You can now add summaries!";
            //document.cookie = `key=${str}`;
            //document.cookie = "key="+str;
            setCookie("key", str, 30);
            const newString = getCookie("key");
            //document.getElementById("errors").innerHTML=newString;
            console.log("It should work at this point");
            isKey = 1;            
            }
          }
        }
        if(isKey === 0) {
        document.getElementById("passcode").placeholder="Wrong code!";
        document.getElementById("passcode").innerHTML="";
        document.getElementById("passcode").value="";
        }


}


    </script>
<p id="success" style="color:green"></p>
</body>
</center>
</html>
